#!/command/with-contenv bash

ENABLE_NGINX=${ENABLE_NGINX:-"TRUE"}
NGINX_AUTHENTICATION_BASIC_PASS=${NGINX_AUTHENTICATION_BASIC_PASS:-password}
NGINX_AUTHENTICATION_BASIC_USER=${NGINX_AUTHENTICATION_BASIC_USER:-admin}
NGINX_AUTHENTICATION_LDAP_ATTRIBUTE=${NGINX_AUTHENTICATION_LDAP_ATTRIBUTE:-"uid"}
NGINX_AUTHENTICATION_LDAP_FILTER=${NGINX_AUTHENTICATION_LDAP_FILTER:-"(objectClass=person)"}
NGINX_AUTHENTICATION_LDAP_GROUP_ATTRIBUTE=${NGINX_AUTHENTICATION_LDAP_GROUP_ATTRIBUTE:-"uniquemember"}
NGINX_AUTHENTICATION_LDAP_SCOPE=${NGINX_AUTHENTICATION_LDAP_SCOPE:-"sub"}
NGINX_AUTHENTICATION_LLNG_HANDLER_HOST=${NGINX_AUTHENTICATION_LLNG_HANDLER_HOST:-"llng-handler:2884"}
NGINX_AUTHENTICATION_LLNG_HANDLER_PORT=${NGINX_AUTHENTICATION_LLNG_HANDLER_PORT:-"2884"}
NGINX_AUTHENTICATION_LLNG_ATTRIBUTE1=${NGINX_AUTHENTICATION_LLNG_ATTRIBUTE1:-"HTTP_AUTH_USER,uid,upstream_http_uid"}
NGINX_AUTHENTICATION_TITLE=${NGINX_AUTHENTICATION_TITLE:-"Please login"}
NGINX_AUTHENTICATION_TYPE=${NGINX_AUTHENTICATION_TYPE:-"NONE"}
NGINX_BLOCK_BOTS_WHITELIST_IP=${NGINX_BLOCK_BOTS_WHITELIST_IP:-"127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/24"}
NGINX_CLIENT_BODY_TIMEOUT=${NGINX_CLIENT_BODY_TIMEOUT:-60}
NGINX_CLIENT_BODY_BUFFER_SIZE=${NGINX_CLIENT_BODY_BUFFER_SIZE:-"16k"}
NGINX_COMPRESSION_BROTLI_LEVEL=${NGINX_COMPRESSION_BROTLI_LEVEL:-6}
NGINX_COMPRESSION_BROTLI_MIN_LENGTH=${NGINX_COMPRESSION_BROTLI_MIN_LENGTH:-20}
NGINX_COMPRESSION_BROTLI_TYPES=${NGINX_COMPRESSION_BROTLI_TYPES:-"text/plain text/css text/xml text/javascript application/x-javascript application/json application/xml"}
NGINX_COMPRESSION_BROTLI_WINDOW=${NGINX_COMPRESSION_BROTLI_WINDOW:-"512k"}
NGINX_COMPRESSION_GZIP_BUFFERS=${NGINX_COMPRESSION_GZIP_BUFFERS:-"16 8k"}
NGINX_COMPRESSION_GZIP_DISABLE=${NGINX_COMPRESSION_GZIP_DISABLE:-"MSIE [1-6].(?!.*SV1)"}
NGINX_COMPRESSION_GZIP_HTTP_VERSION=${NGINX_COMPRESSION_GZIP_HTTP_VERSION:-"1.1"}
NGINX_COMPRESSION_GZIP_LEVEL=${NGINX_COMPRESSION_GZIP_LEVEL:-6}
NGINX_COMPRESSION_GZIP_MIN_LENGTH=${NGINX_COMPRESSION_GZIP_MIN_LENGTH:-10240}
NGINX_COMPRESSION_GZIP_PROXIED=${NGINX_COMPRESSION_GZIP_PROXIED:-"expired no-cache no-store private auth"}
NGINX_COMPRESSION_GZIP_TYPES=${NGINX_COMPRESSION_GZIP_TYPES:-"text/plain text/css text/xml text/javascript application/x-javascript application/json application/xml"}
NGINX_COMPRESSION_GZIP_VARY=${NGINX_COMPRESSION_GZIP_VARY:-"TRUE"}
NGINX_DDOS_CONNECTIONS_PER_IP=${NGINX_DDOS_CONNECTIONS_PER_IP:-"10m"}
NGINX_DDOS_REQUESTS_PER_IP=${NGINX_DDOS_REQUESTS_PER_IP:-"5r/s"}
NGINX_ENABLE_APPLICATION_CONFIGURATION=${NGINX_ENABLE_APPLICATION_CONFIGURATION:-"TRUE"}
NGINX_ENABLE_BLOCK_BOTS=${NGINX_ENABLE_BLOCK_BOTS:-"FALSE"}
NGINX_ENABLE_COMPRESSION_BROTLI=${NGINX_ENABLE_COMPRESSION_BROTLI:-"TRUE"}
NGINX_ENABLE_COMPRESSION_GZIP=${NGINX_ENABLE_COMPRESSION_GZIP:-"TRUE"}
NGINX_ENABLE_CREATE_SAMPLE_HTML=${NGINX_ENABLE_CREATE_SAMPLE_HTML:-"TRUE"}
NGINX_ENABLE_DDOS_PROTECTION=${NGINX_ENABLE_DDOS_PROTECTION:-"FALSE"}
NGINX_ENABLE_EPOLL=${NGINX_ENABLE_EPOLL:-"TRUE"}
NGINX_ENABLE_EXPLOIT_PROTECTION=${NGINX_ENABLE_EXPLOIT_PROTECTION:-"TRUE"}
NGINX_ENABLE_FASTCGI_HTTPS=${NGINX_ENABLE_FASTCGI_HTTPS:-"FALSE"}
NGINX_ENABLE_MULTI_ACCEPT=${NGINX_ENABLE_MULTI_ACCEPT:-"TRUE"}
NGINX_ENABLE_OPEN_FILE_CACHE=${NGINX_ENABLE_OPEN_FILE_CACHE:-"TRUE"}
NGINX_ENABLE_OPEN_FILE_CACHE_ERRORS=${NGINX_ENABLE_OPEN_FILE_CACHE_ERRORS:-"TRUE"}
NGINX_ENABLE_RESET_TIMEDOUT_CONNECTION=${NGINX_ENABLE_RESET_TIMEDOUT_CONNECTION:-"TRUE"}
NGINX_ENABLE_PROXY_BUFFERING=${NGINX_ENABLE_PROXY_BUFFERING:-"TRUE"}
NGINX_ENABLE_REVERSE_PROXY=${NGINX_ENABLE_REVERSE_PROXY:-"TRUE"}
NGINX_ENABLE_SENDFILE=${NGINX_ENABLE_SENDFILE:-"TRUE"}
NGINX_ENABLE_SERVER_TOKENS=${NGINX_ENABLE_SERVER_TOKENS:-"FALSE"}
NGINX_ENABLE_SITE_OPTIMIZATION=${NGINX_ENABLE_SITE_OPTIMIZATION:-"TRUE"}
NGINX_ENABLE_TCPNODELAY=${NGINX_ENABLE_TCPNODELAY:-"TRUE"}
NGINX_ENABLE_TCPNOPUSH=${NGINX_ENABLE_TCPNOPUSH:-"TRUE"}
NGINX_ENABLE_UPSTREAM_KEEPALIVE=${NGINX_ENABLE_UPSTREAM_KEEPALIVE:-"TRUE"}
NGINX_FASTCGI_BUFFERS=${NGINX_FASTCGI_BUFFERS:-"16 16k"}
NGINX_FASTCGI_BUFFER_SIZE=${NGINX_FASTCGI_BUFFER_SIZE:-"32k"}
NGINX_FORCE_RESET_PERMISSIONS=${NGINX_FORCE_RESET_PERMISSIONS:-"TRUE"}
NGINX_KEEPALIVE_REQUESTS=${NGINX_KEEPALIVE_REQUESTS:-100000}
NGINX_KEEPALIVE_TIMEOUT=${NGINX_KEEPALIVE_TIMEOUT:-75}
NGINX_LISTEN_PORT=${NGINX_LISTEN_PORT:-80}
NGINX_LOG_ACCESS_FILE=${NGINX_LOG_ACCESS_FILE:-"access.log"}
NGINX_LOG_ACCESS_LOCATION=${NGINX_LOG_ACCESS_LOCATION:-"/www/logs/nginx/"}
NGINX_LOG_ERROR_FILE=${NGINX_LOG_ERROR_FILE:-"error.log"}
NGINX_LOG_ERROR_LOCATION=${NGINX_LOG_ERROR_LOCATION:-"/www/logs/nginx/"}
NGINX_LOG_ACCESS_FORMAT=${NGINX_LOG_ACCESS_FORMAT:-"standard"}
NGINX_LOG_LEVEL_ERROR=${NGINX_LOG_LEVEL_ERROR:-"warn"}
NGINX_LOG_BLOCKED_FORMAT=${NGINX_LOG_BLOCKED_FORMAT:-"standard"}
NGINX_LOG_BLOCKED_FILE=${NGINX_LOG_BLOCKED_FILE:-"blocked.log"}
NGINX_LOG_BLOCKED_LOCATION=${NGINX_LOG_BLOCKED_LOCATION:-"/www/logs/nginx/"}
NGINX_MAINTENANCE_FILE=${NGINX_MAINTENANCE_FILE:-"index.html"}
NGINX_MAINTENANCE_PATH=${NGINX_MAINTENANCE_PATH:-"/assets/nginx/maintenance/"}
NGINX_MAINTENANCE_TYPE=${NGINX_MAINTENANCE_TYPE:-"local"}
NGINX_MAINTENANCE_PROXY_URL=${NGINX_MAINTENANCE_PROXY_URL:-"http://maintenance"}
NGINX_MODE=${NGINX_MODE:-"NORMAL"}
NGINX_OPEN_FILE_CACHE_ERRORS=${NGINX_OPEN_FILE_CACHE_ERRORS:-"on"}
NGINX_OPEN_FILE_CACHE_INACTIVE=${NGINX_OPEN_FILE_CACHE_INACTIVE:-"5m"}
NGINX_OPEN_FILE_CACHE_MAX=${NGINX_OPEN_FILE_CACHE_MAX:-200000}
NGINX_OPEN_FILE_CACHE_MIN_USES=${NGINX_OPEN_FILE_CACHE_MIN_USES:-2}
NGINX_OPEN_FILE_CACHE_VALID=${NGINX_OPEN_FILE_CACHE_VALID:-"2m"}
NGINX_PROXY_BUFFERS=${NGINX_PROXY_BUFFERS:-"4 256k"}
NGINX_PROXY_BUFFER_SIZE=${NGINX_PROXY_BUFFER_SIZE:-"128k"}
NGINX_PROXY_BUSY_BUFFERS_SIZE=${NGINX_PROXY_BUSY_BUFFERS_SIZE:-"256k"}
NGINX_REAL_IP_HEADER=${NGINX_REAL_IP_HEADER:-"X-Forwarded-For"}
NGINX_RELOAD_ON_CONFIG_CHANGE=${NGINX_RELOAD_ON_CONFIG_CHANGE:-"FALSE"}
NGINX_SEND_TIMEOUT=${NGINX_SEND_TIMEOUT:-60}
NGINX_SERVER_NAMES_HASH_BUCKET_SIZE=${NGINX_SERVER_NAMES_HASH_BUCKET_SIZE:-"32"}
NGINX_SET_REAL_IP_FROM=${NGINX_SET_REAL_IP_FROM:-"172.16.0.0/12"}
NGINX_UPLOAD_MAX_SIZE=${NGINX_UPLOAD_MAX_SIZE:-"2G"}
NGINX_UPSTREAM_KEEPALIVE=${NGINX_UPSTREAM_KEEPALIVE:-"32"}
NGINX_USER=${NGINX_USER:-"nginx"}
NGINX_GROUP=${NGINX_GROUP:-"www-data"}
NGINX_WEBROOT=${NGINX_WEBROOT:-"/www/html"}
NGINX_WORKER_CONNECTIONS=${NGINX_WORKER_CONNECTIONS:-"1024"}
NGINX_WORKER_PROCESSES=${NGINX_WORKER_PROCESSES:-"auto"}
NGINX_WORKER_RLIMIT_NOFILE=${NGINX_WORKER_RLIMIT_NOFILE:-100000}
STAGE=${STAGE:-"DEVELOP"}

if [ "${NGINX_LOG_ACCESS_FORMAT,,}" = "standard" ] && [ "${NGINX_AUTHENTICATION_TYPE,,}" = "llng" ] ; then
    NGINX_LOG_ACCESS_FORMAT=llng_standard
fi

if [ "${NGINX_LOG_ACCESS_FORMAT,,}" = "json" ] && [ "${NGINX_AUTHENTICATION_TYPE,,}" = "llng" ] ; then
    NGINX_LOG_ACCESS_FORMAT=llng_json
fi